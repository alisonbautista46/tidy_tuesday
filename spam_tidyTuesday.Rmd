---
title: "Tidy Tuesday - Spam"
author: "Alison Bautista"
date: "2023-08-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(tidytuesdayR)
library(scales)
library(ggtext)
library(showtext)
library(tidytext)
library(data.table)
library(paletteer)
library(extrafont)
library(RColorBrewer)
library(cowplot)
library(magick)
```

```{r}
tuesdata <- tidytuesdayR::tt_load(2023, week = 33)

spam <- tuesdata$spam

#remove the first column
spam <- spam[,-1]
```
```{r}
spam_data <- melt(spam, id.vars = "yesno", variable.factor = FALSE, value.factor = FALSE)
```

```{r}
df <- spam_data %>% 
  filter(value!= 0) %>% 
  group_by(variable, yesno) %>%
  mutate(yesno = case_when(
    yesno == "y" ~ "Spam",
    yesno == "n" ~ "Not Spam")) %>% 
  summarise(sum_value = sum(value), count = n()) %>%
  distinct() %>%
  mutate(perc_occurances = paste(round((count/sum(count)*100), 2), "%"),
         perc_emails = sum(count)/ nrow(spam))


```



```{r}

spam_plot <- df %>%
  ggplot(aes(x = count, y = variable, fill = yesno)) + 
  geom_col(color = 'grey') +
  scale_fill_manual(values=c('midnightblue', 'rosybrown2')) +
  scale_x_continuous(limits = c(0, 2500)) +
  geom_text(aes(group = yesno, 
                label = (ifelse(yesno == "Spam", perc_occurances, ""))), 
                hjust = 1.1, 
                nudge_x = -1,
                size = 3, 
                fontface = "bold") + 
  labs(title = "SPAM",
       subtitle = "Characters and words that cause emails to be flagged as Spam.\nTotal length of columns indicate how many emails out of the 4600 contained the specified characters, \nand how many emails which contain those characters are flagged as spam",
       caption = "Source: Vincent Arel-Bundock's Rdatasets- Spam Emails | Data Viz by Alison Bautista") +
  xlab("Total Number of emails") +
  ylab("") +
  theme(panel.background = element_rect(fill = 'midnightblue'),
        panel.grid.major = element_line(color = 'midnightblue'),
        panel.grid.minor = element_line(color = 'midnightblue'),
        plot.background = element_rect(fill = 'midnightblue'),
        legend.background = element_rect(fill = 'midnightblue'),
        legend.title = element_blank(),
        legend.text = element_text(color = "grey"),
        plot.title = element_text(face = "bold", color = "gold", family = "PT Serif", size = 80, vjust-15),
        plot.subtitle = element_text(color = 'grey', size = 12, vjust = 6, family = "Spot Mono"),
        plot.caption = element_text(color = 'grey', size = 10, hjust = -0.1),
        axis.title.x = element_text(color = "grey", face = "bold", family = "PT Serif"),
        axis.text = element_text(color = 'gold', face = "bold", size = 10, family = "PT Serif")
        )

spam_plot
```



